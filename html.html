<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body>
    <div>
        <input id="id" type="hidden">
        <label for="name">Name:</label>
        <input id="name"> <br>
        <label for="email">Email:</label>
        <input id="email"><br>
        <label for="number">Number:</label>
        <input id="number"><br>
        <label for="btn"></label>
        <button id="btn" onclick="editoradd()" >send</button>
        


    </div>
    <div>
        <br>
        <label for='find' oninput="Search()"><input id="find"></label> 
        <!-- <button onclick="Search(document.getElementById('find').value)">Search</button>  -->
        <table border="1">
            <tr>
                <th>Delete</th>
                <th>ID</th>
                <th>Nmae</th>
                <th>Email</th>
                <th>Phone</th>
                <th>Edit</th>
            </tr>
            
            <tbody id="myTable"></tbody>
        </table>
    </div>
    

    <script>
        let contacts = JSON.parse(localStorage.getItem('contacts')) || [];

        function createContacts(data){
            let txt = "";
            for(obj of data){
                txt += `<tr><td><button onclick="deletec(${obj.id})">Detele</button>`
                for(x in obj)
                {
                    txt+=`<td>${obj[x]}</td>`
                }
                txt += `<td><button onclick="Editc(${obj.id})">Edit</button></td></tr>`

            }
            document.getElementById('myTable').innerHTML = txt;
            document.getElementById('name').value = "";
            document.getElementById('number').value = "";
            document.getElementById('email').value = "";
            document.getElementById('id').value = "";
            
        }
        function addcontact(){
            
            let name = document.getElementById('name').value;
            
            let email = document.getElementById('email').value;
            let number = document.getElementById('number').value;
            
            let id = contacts.length + 1;
            let obj = {id,name,email,number};
            contacts.push(obj);
            resortids();
            createContacts(contacts);
            rstorage();

        }

        function resortids()
        {
            for(let i = 0; i < contacts.length; i++)
            {
                contacts[i].id = i + 1 ;
            }
            rstorage();
            
        }
        function deletec(id){
            contacts = contacts.filter(x => x.id != id);
            resortids()
            createContacts(contacts);
            rstorage();
        }

        function Editc(id){
            document.getElementById('name').value = contacts[id-1].name;
            document.getElementById('number').value = contacts[id-1].number;
            document.getElementById('email').value = contacts[id-1].email;
            document.getElementById('id').value = id;
        }

            function editoradd(){
                let id = -1
                if(document.getElementById('id').value != "") 
                {
                    id = document.getElementById('id').value;
                
                }
                
            
                if (id <= contacts.length && id > -1){
                    contacts[id-1].name = document.getElementById('name').value;
                    contacts[id-1].number = document.getElementById('number').value;
                    contacts[id-1].email = document.getElementById('email').value;
                    createContacts(contacts);
                    
                }
                else
                {
                    addcontact();
                }
                rstorage();

            
            
            }
        console.log(contacts);
        function rstorage(){
        localStorage.setItem('contacts', JSON.stringify(contacts));
        }

        function Search(){
            let val = document.getElementById('find').value;
            if (val){
            let tempcontacts = contacts.filter(x => x.name.toLowerCase().includes(val));
            createContacts(tempcontacts);
            }
            else
            {
                createContacts(contacts);
            }

        }
        createContacts(contacts);

    </script>
    
</body>
</html>